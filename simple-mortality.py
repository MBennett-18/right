import random
import matplotlib.pyplot as plt

MALE_DEATHS_2010_CDF=[0,0.00671,0.00716,0.00748,0.00772,0.00789,0.00803,0.00816,0.00828,0.00841,0.00853,0.00863,0.00877,0.00892,0.0091,0.00934,0.00966,0.01015,0.0108,0.01174,0.01276,0.01387,0.01512,0.01636,0.01763,0.01897,0.02026,0.02158,0.02288,0.02422,0.02558,0.02695,0.02838,0.0298,0.03127,0.03271,0.03423,0.0358,0.03748,0.03927,0.04118,0.04314,0.04528,0.04765,0.05016,0.053,0.05612,0.05956,0.06332,0.06738,0.07187,0.07669,0.08179,0.08744,0.09355,0.09995,0.10695,0.11442,0.12246,0.13101,0.14001,0.14947,0.15921,0.16973,0.1813,0.19272,0.20545,0.21895,0.2336,0.24878,0.26506,0.28235,0.30042,0.32001,0.3404,0.3623,0.38589,0.41023,0.43619,0.46337,0.49155,0.52135,0.55193,0.58421,0.6166,0.64974,0.68326,0.71661,0.74986,0.78289,0.81428,0.84479,0.87169,0.89711,0.91913,0.93807,0.95338,0.96581,0.97561,0.9831,0.98864,0.99259,0.99532,0.99714,0.99831,0.99903,0.99946,0.99971,0.99985,0.99993,0.99996,1.00000]

FEMALE_DEATHS_2010_CDF=[0,0.00557,0.00598,0.00621,0.00637,0.00651,0.00661,0.00672,0.00681,0.00692,0.00701,0.00711,0.00722,0.00734,0.00746,0.00761,0.00778,0.00803,0.0083,0.00862,0.009,0.0094,0.00983,0.01027,0.01072,0.01122,0.01172,0.01224,0.01276,0.01335,0.01397,0.01463,0.01529,0.01602,0.01674,0.01753,0.01839,0.01933,0.02032,0.0214,0.02257,0.02379,0.02514,0.02661,0.02825,0.03007,0.03202,0.03429,0.0367,0.03929,0.04212,0.04521,0.04847,0.0521,0.05584,0.0599,0.06408,0.06865,0.07346,0.0787,0.08421,0.09011,0.09649,0.10341,0.11135,0.11921,0.12809,0.13775,0.1484,0.15955,0.17157,0.18466,0.19873,0.21402,0.23018,0.24774,0.26708,0.28727,0.30938,0.33313,0.35804,0.3849,0.41307,0.44365,0.47566,0.5094,0.54505,0.58196,0.61953,0.65846,0.69763,0.7368,0.7736,0.80982,0.84296,0.87312,0.89972,0.92268,0.94194,0.95761,0.96995,0.97935,0.98626,0.99116,0.9945,0.9967,0.99809,0.99893,0.99942,0.9997,0.99985,1.00000]

def r_cont(cdf):
    x = random.random()
    return [ n for n,i in enumerate(cdf) if i>=x ][0]

def random_death(gender):
    if gender == 'M':
        return r_cont(MALE_DEATHS_2010_CDF)
    elif gender == 'F':
        return r_cont(FEMALE_DEATHS_2010_CDF)
    else:
        raise ValueError('Invalid gender specified')

def random_gender():
    if random.random < 0.5:
        return 'M'
    else:
        return 'F'


def sim(n=500):
    death_ages=[]
    for _ in range(500):
        gender = random_gender()
        death = 0
        while death < 50: death  = random_death(gender) 
        death_ages.append(death)
    return death_ages

x = sim()
plt.hist(x, normed=1, alpha=0.75)
plt.title("Mortality Simulation 500 Individuals")
plt.xlabel("Age at Death")
plt.ylabel("Density")
plt.show()
